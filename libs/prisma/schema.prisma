generator client {
  provider = "prisma-client-js"
}

//generator trpc {
//  provider      = "prisma-trpc-generator"
//  withMiddlware = false
//  withShield    = false
//}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum PublicationStatus {
  PUBLISHED
  DRAFT
}

enum Visibility {
  PUBLIC
  PROTECTED
  PRIVATE
}

model ArticleTag {
  id       Int       @id @default(autoincrement())
  title    String
  slug     String    @unique
  articles Article[]

  @@index([id, slug])
}

model Article {
  id             Int               @id @default(autoincrement())
  createdAt      DateTime          @default(now())
  updatedAt      DateTime          @updatedAt
  title          String
  slug           String            @unique
  content        String            @db.Text
  tags           ArticleTag[]
  seo_title      String
  seo_excerpt    String            @db.Text
  featured_image String
  published      PublicationStatus @default(DRAFT)
  publishedAt    DateTime?
}

model ClockifyTimer {
  projectId String @unique
  startTime String
  id        Int    @id @default(autoincrement())

  @@index([id])
}

model DiscordUserSetting {
  userId String @id @unique
  meta   Json
}

model Gallery {
  id          Int               @id @default(autoincrement())
  createdAt   DateTime          @default(now())
  updatedAt   DateTime          @updatedAt
  title       String
  slug        String            @unique
  meta        String            @db.Text
  description String            @db.Text
  visibility  Visibility        @default(PUBLIC)
  isNsfw      Boolean           @default(false)
  image       String
  categories  GalleryCategory[]
  tags        GalleryTag[]
  images      GalleryImage[]

  @@index([id, slug])
}

model GalleryCategory {
  id        Int      @id @default(autoincrement())
  title     String
  slug      String   @unique
  Gallery   Gallery? @relation(fields: [galleryId], references: [id])
  galleryId Int?

  @@index([id, slug])
}

model GalleryImage {
  id          Int               @id @default(autoincrement())
  createdAt   DateTime          @default(now())
  updatedAt   DateTime          @updatedAt
  title       String
  slug        String            @unique
  galleries   Gallery[]
  published   PublicationStatus
  publishedAt DateTime
  visibility  Visibility?
  url         String

  @@index([id, slug])
}

model GalleryTag {
  id        Int      @id @default(autoincrement())
  title     String
  slug      String   @unique
  Gallery   Gallery? @relation(fields: [galleryId], references: [id])
  galleryId Int?

  @@index([id, slug])
}

model ImageExif {
  id   Int    @id @default(autoincrement())
  url  String @unique
  exif Json

  @@index([id])
}

model ImageBase64 {
  public_id String @id
  encoded   String
}

model Marker {
  id         Int     @id @default(autoincrement())
  lat        Decimal
  lon        Decimal
  siteURL    String?
  galleryURL String?
  title      String
  rating     Int     @default(0)
  visited    Boolean @default(false)
  visits     Int     @default(0)

  @@index([id])
}

model MinecraftRule {
  id          Int                   @id @default(autoincrement())
  name        String
  description String
  createdAt   DateTime              @default(now())
  updatedAt   DateTime              @updatedAt
  categoryId  Int
  category    MinecraftRuleCategory @relation(fields: [categoryId], references: [id])

  @@index([id])
}

model MinecraftRuleCategory {
  id             Int             @id @default(autoincrement())
  name           String          @unique
  icon           String
  MinecraftRules MinecraftRule[]

  @@index([id])
}
